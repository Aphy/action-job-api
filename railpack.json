{
  "$schema": "https://schema.railpack.com",

  "steps": {
    "install": {
      "inputs": [
        { "image": "composer:2" }
      ],
      "commands": [
        { "cmd": "composer install --working-dir=api --no-dev --prefer-dist --no-interaction --optimize-autoloader --no-scripts -vvv" }
      ],
      "deployOutputs": [
        { "include": ["/api/vendor"] }
      ]
    },

    "build": {
      "inputs": [
        { "step": "install" }
      ],
      "commands": [],
      "deployOutputs": [
        { "include": ["."] }
      ]
    }
  },

  "deploy": {
    "inputs": [
      { "step": "build", "include": ["."] }
    ],
    "variables": {
      "APP_ENV": "prod",
      "RAILPACK_PHP_ROOT_DIR": "api/public"
    },
    "startCommand": "./api/entrypoint.sh"
  }
}
